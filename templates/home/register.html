{% extends "layouts/base.html" %}

{% block title %} Register {% endblock %} 

<!-- Specific CSS goes HERE -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}

    <!-- [ Main Content ] start -->
    <div class="pcoded-main-container">
        <div class="pcoded-wrapper">

            <div class="pcoded-content">
                <div class="pcoded-inner-content">
                    <div class="main-body">
                        <div class="page-wrapper">
                            <!-- [ Main Content ] start -->
                            <div class="card">
                                <div class="card-body text-center">
                                    <div class="mb-4">
                                        <i class="feather icon-user-plus auth-icon"></i>
                                    </div>
                                    <h3 class="mb-4">Register User</h3>
                                    <span class="mb-0 text-muted">
                                      
                                            <span class="text-danger"  >   <p id="message" style="color: red;"></p></span>
                                    
                                    </span>
                
                                    <br />
                                    <br />
                
                                    <form role="form"  id="RegisterForm" method="post" action="">
                                    <div class="input-group mb-3">
                                        <input type="text" class="form-control"  id="username" placeholder="Username" required>
                                    </div>
                                   <!-- <div class="input-group mb-3">
                                        <input type="email" class="form-control"  placeholder="Email">
                                    </div>-->
                                    <div class="input-group mb-4">
                                        <input type="password" class="form-control"   id="password" placeholder="password" required>
                                    </div>
                                  
                                   
                                    <button type="submit" class="btn btn-primary shadow-2 mb-4">Create User</button>
                                </form>
                                </div>
                            </div>
                            <!-- [ Main Content ] end -->
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
    </div>
    <!-- [ Main Content ] end -->
    <script>
        document.getElementById('RegisterForm').addEventListener('submit', function(event) {
            event.preventDefault();
    
            let formData = {
                username: document.getElementById('username').value,
                password: document.getElementById('password').value
            };
    
            fetch('api/users', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(formData)
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json(); // Parse JSON response
            })
            .then(data => {
                console.log('Success:', data);
                // Redirect to landing page on successful login
                window.location.href = '/viewusers';
            })
            .catch(error => {
                console.error('Error:', error);
                // Handle error (e.g., show error message)
                document.getElementById('message').innerText = 'Invalid users try again.';
            });
        });
    </script>
{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}{% endblock javascripts %}
